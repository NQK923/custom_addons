<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="reporting_and_data_analysis.InvoiceDashboardGraph" owl="1">
        <div class="o_invoice_dashboard_graph" t-ref="graph">
            <!-- Graph will be rendered here -->
        </div>
    </t>

    <t t-name="reporting_and_data_analysis.InvoiceTopDataWidget" owl="1">
        <div class="o_invoice_top_data_widget">
            <!-- Top Services Table -->
            <t t-if="props.name === 'top_services_data' and state.data.length">
                <table class="table table-sm table-striped mb-0">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Tên dịch vụ</th>
                            <th class="text-end">Số lượng</th>
                            <th class="text-end">Doanh thu</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="state.data" t-as="service" t-key="service_index">
                            <tr>
                                <td><t t-esc="service_index + 1"/></td>
                                <td><t t-esc="service.name"/></td>
                                <td class="text-end"><t t-esc="service.count_formatted"/></td>
                                <td class="text-end"><t t-esc="service.total_formatted"/></td>
                            </tr>
                        </t>
                    </tbody>
                </table>
                <div t-if="!state.data.length" class="text-center p-3">
                    Không có dữ liệu
                </div>
            </t>

            <!-- Top Products Table -->
            <t t-if="props.name === 'top_products_data' and state.data.length">
                <table class="table table-sm table-striped mb-0">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Tên thuốc</th>
                            <th class="text-end">Số lượng</th>
                            <th class="text-end">Doanh thu</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="state.data" t-as="product" t-key="product_index">
                            <tr>
                                <td><t t-esc="product_index + 1"/></td>
                                <td><t t-esc="product.name"/></td>
                                <td class="text-end"><t t-esc="product.count_formatted"/></td>
                                <td class="text-end"><t t-esc="product.total_formatted"/></td>
                            </tr>
                        </t>
                    </tbody>
                </table>
                <div t-if="!state.data.length" class="text-center p-3">
                    Không có dữ liệu
                </div>
            </t>

            <!-- Top Patients Table -->
            <t t-if="props.name === 'top_patients_data' and state.data.length">
                <table class="table table-sm table-striped mb-0">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Bệnh nhân</th>
                            <th class="text-end">Số lần khám</th>
                            <th class="text-end">Doanh thu</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="state.data" t-as="patient" t-key="patient_index">
                            <tr>
                                <td><t t-esc="patient_index + 1"/></td>
                                <td><t t-esc="patient.name"/></td>
                                <td class="text-end"><t t-esc="patient.count_formatted"/></td>
                                <td class="text-end"><t t-esc="patient.total_formatted"/></td>
                            </tr>
                        </t>
                    </tbody>
                </table>
                <div t-if="!state.data.length" class="text-center p-3">
                    Không có dữ liệu
                </div>
            </t>

            <!-- Monthly Comparison -->
            <t t-if="props.name === 'monthly_comparison_data' and state.data.total">
                <div class="row">
                    <!-- Tổng doanh thu -->
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5>Tổng doanh thu</h5>
                                <h2><t t-esc="state.data.total.current_formatted"/></h2>
                                <p t-attf-class="{{state.data.total.growth_formatted.positive ? 'text-success' : 'text-danger'}}">
                                    <i t-attf-class="fa {{state.data.total.growth_formatted.positive ? 'fa-arrow-up' : 'fa-arrow-down'}}"></i>
                                    <t t-esc="state.data.total.growth_formatted.value"/>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Doanh thu dịch vụ -->
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5>Doanh thu dịch vụ</h5>
                                <h2><t t-esc="state.data.service.current_formatted"/></h2>
                                <p t-attf-class="{{state.data.service.growth_formatted.positive ? 'text-success' : 'text-danger'}}">
                                    <i t-attf-class="fa {{state.data.service.growth_formatted.positive ? 'fa-arrow-up' : 'fa-arrow-down'}}"></i>
                                    <t t-esc="state.data.service.growth_formatted.value"/>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Doanh thu thuốc -->
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5>Doanh thu thuốc</h5>
                                <h2><t t-esc="state.data.medicine.current_formatted"/></h2>
                                <p t-attf-class="{{state.data.medicine.growth_formatted.positive ? 'text-success' : 'text-danger'}}">
                                    <i t-attf-class="fa {{state.data.medicine.growth_formatted.positive ? 'fa-arrow-up' : 'fa-arrow-down'}}"></i>
                                    <t t-esc="state.data.medicine.growth_formatted.value"/>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div t-if="!state.data.total" class="text-center p-3">
                    Không có dữ liệu so sánh
                </div>
            </t>
        </div>
    </t>
</templates>